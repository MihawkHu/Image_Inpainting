%% CVPR_3X3_FOE - Our learned 3x3 FoE as described in the paper
% 
%  Uwe Schmidt, Qi Gao, Stefan Roth.
%  A Generative Perspective on MRFs in Low-Level Vision.
%  IEEE Conference on Computer Vision and Pattern Recognition (CVPR'10), San Francisco, USA, June 2010.

% Copyright 2010 TU Darmstadt, Darmstadt, Germany.
% $Id: cvpr_3x3_foe.m 230 2010-07-07 11:09:46Z uschmidt $

function mrf = cvpr_3x3_foe
  gsm = pml.distributions.gsm;
  gsm.precision = 1/500;
  gsm.scales = exp([-9,-7,-5:5,7,9]);
  experts = repmat({gsm}, 1, 8);
  
  J = [5.2340749435117573e-02  -7.3377284351638927e-04   3.3350467989282695e-01  -1.6264659492975397e-02  -1.0693678311483623e-01   8.8729579475398168e-02   3.8558180054248936e-04   4.5684787352229250e-05;  -1.1284458299849831e-01   1.2682870427460635e-04  -3.9143598361584075e-01  -1.5653952041503771e-01   2.0635922900201109e-01   1.2887645337596609e-01   8.7993438122380141e-05   1.0074501609769193e-04;   5.3266961678041014e-02   3.2588550580703313e-04   5.9379573962542231e-02  -8.8774979707721968e-03  -1.0852518955450208e-01   1.3108774662129008e-02  -1.4301861177634656e-04   1.2819754094950397e-05;   1.0769558318880001e-01  -9.2825122690176620e-04  -4.1185391345622513e-01   1.5980809728866063e-04   2.0919616858487089e-01  -2.0444390222624520e-01   1.0123467923828233e-03  -1.3563312653409598e-03;  -1.9844571038213843e-01   2.6818936734063215e-05   4.2679875199883544e-01  -4.8134012454070785e-04  -4.1812467012273657e-01  -2.3332992165477151e-01  -3.8686998937720318e-06   5.0931351401328762e-05;   1.0534465680657945e-01   9.0474401749185418e-04  -1.8312087046211012e-02  -2.7800664479133985e-03   2.2534128836310785e-01  -2.8516510105646375e-02  -9.9215955592990568e-04   1.4213112086702839e-03;   3.8023728521629607e-02  -3.1868353331310217e-04   7.7974307658704056e-02   1.3765842384348304e-02  -1.0735790468867989e-01   1.1322474554762607e-01   1.1017461216966673e-04  -3.7074359624855724e-05;  -7.1074210540324145e-02  -1.2112615340864608e-04  -3.5076632506394922e-02   1.5753989431167170e-01   2.2487932143760148e-01   1.1283952565540289e-01  -8.9447569578071651e-05  -1.5160842705219668e-04;   2.5692824290750593e-02   7.1755659282990436e-04  -4.0978696888235966e-02   1.3477539657946735e-02  -1.2483145990681521e-01   9.5112552701834829e-03  -3.6760220604015181e-04  -8.6478065599138176e-05];
  experts{1}.weights = [3.4015166526357103e-02   3.7504736398748198e-02   5.0031934603208261e-02   6.7885543604641732e-02   1.0982028084965093e-01   2.1132908206948015e-01   2.7261251658180652e-01   1.1682887149995629e-01   4.3606467638693781e-02   2.0149133849359478e-02   1.1614415191442212e-02   8.1040268553697267e-03   6.4439023624350729e-03   4.3056913526677990e-03   5.7482306161828816e-03]';
  experts{2}.weights = [5.5150670245583566e-02   5.6648693839521702e-02   6.1010623113922247e-02   6.5785534862195308e-02   7.3918498748251335e-02   8.7029529030763178e-02   1.0519936566421290e-01   1.2092159519462278e-01   1.1695563263064905e-01   9.1602006076585640e-02   6.4378275215421346e-02   4.5224177961061165e-02   3.3034468147183971e-02   1.7409325472703598e-02   5.7316037973222256e-03]';
  experts{3}.weights = [2.9207863185688302e-02   3.4203148939338096e-02   5.4302912457710642e-02   8.6310143644173193e-02   1.7271568964311118e-01   3.2990558815314586e-01   1.7182524996071541e-01   5.7458307110226002e-02   2.4403466282535632e-02   1.3070921937396994e-02   8.4159674352139568e-03   6.1354946278353271e-03   4.7334095121737974e-03   3.1609610071072687e-03   4.1508761036280935e-03]';
  experts{4}.weights = [2.1793573203760595e-02   2.5936921431933452e-02   4.3718443658722891e-02   7.5608273205547818e-02   1.8558746840055854e-01   4.3598190959371297e-01   1.3194933324434302e-01   3.8558965880016977e-02   1.5944835195507056e-02   8.3532101353650679e-03   5.2908677758833362e-03   3.9028260733220228e-03   3.1613900354697374e-03   2.0937967543191850e-03   2.1181854115373466e-03]';
  experts{5}.weights = [4.1360752077370763e-02   4.3636730136032115e-02   5.0958701208049052e-02   6.0295304581956907e-02   8.0066382672998121e-02   1.2552803716128635e-01   2.1595117637544256e-01   2.0143785044849352e-01   8.5031753255993117e-02   3.7219764351644403e-02   2.0193882013757204e-02   1.3041279638745955e-02   9.4479500235835259e-03   6.0447011437682850e-03   9.7857349108781619e-03]';
  experts{6}.weights = [2.9818852691738899e-02   3.3038328922704675e-02   4.4762385749607767e-02   6.2289574390790615e-02   1.0952953076192755e-01   2.6609758193686278e-01   2.9834803534770554e-01   8.1739755111821480e-02   2.9194941120835340e-02   1.4519866725712795e-02   9.2485335203308216e-03   7.0733338168666674e-03   5.9973966453902407e-03   4.0056958174294281e-03   4.3361874402753856e-03]';
  experts{7}.weights = [6.0011897547490804e-02   6.0890510995344531e-02   6.3346059615938574e-02   6.5885370284002973e-02   6.9906659136599089e-02   7.5744853156330158e-02   8.3079849707027961e-02   9.0094557128790484e-02   9.3202776036356016e-02   8.9500632743687428e-02   8.0178597130816848e-02   6.9167905523001075e-02   5.8691024024862266e-02   3.2505382034241449e-02   7.7939249355102160e-03]';
  experts{8}.weights = [5.2212362837941124e-02   5.4641151810027655e-02   6.2056621416947157e-02   7.0552641768683810e-02   8.5411378027003576e-02   1.0881691702964980e-01   1.3422297658073593e-01   1.3521995139729590e-01   1.0349752144611810e-01   6.9337519730793426e-02   4.6792958994640796e-02   3.3384067728175079e-02   2.5077642846622120e-02   1.3983855493356522e-02   4.7924328920091776e-03]';
  
  mrf = pml.distributions.gsm_foe;
  mrf = mrf.set_filter(eye(9), J, [3 3]);
  mrf.experts = experts;
end

